[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Working with EXIF Data",
    "section": "",
    "text": "Hello!\nThe below webpage is a quick introduction to working with EXIF data. It also provides a quick overview of working with command line tools, if you are unfamiliar with for MacOS (and which will be broadly similar for Linux aswell).\n\n\nEXIF data\nWe are going to start of by using R. This is very straightforward, even if you are not familiar R and we can start to explore our EXIF data from here.\nWe are going to look at the EXIF data for a picture of my cat :)\n\n\n\nMy cat Siddhi\n\n\nSave this image to your computer so we can load it with the code below.\n\n\nRStudio\nFirst we need to install the exiftoolR library so that we have the appropriate tools to read exif data.\n\n#install.packages('exiftoolr', repos = \"http://cran.us.r-project.org\")\n\nlibrary(exiftoolr)\n\nThen we simply read in our photograph using exiftoolR.\n\ncat_exif &lt;- exif_read('media/Siddhi.jpg') # you need to change this path to the one where your photo is located\n\nYou can then use commands line colnames(cat_exif) or the dataviewer in RStudio to browse through the data.\n\n\nWhat suprised you about the infomation attached to this image?\n\n\nNow load in your image and explore the metadata\n\n\nTry loading in differt pictures (and file formats) and see what changes\n\n\n\nCommand Line Tools\nEverything after this point is optional you do not have to use them for this class, but you might find it interesting\nexiftoolR is a very useful package (and we will be making more use of it next week!) but at heart it is just an R version of the excellent set of command line EXIFTools which we can use to examine the EXIF data in more depth (and manipulate it if we want).\nIf you are on windows and want to use the tool just follow the instructions on the EXIFTools webpage.\nIf you are on a Mac you can install EXIFTools as a command line tool with ease using homebrew.\nHomebrew is a package manger that allows you to install command line (and other tools) with ease, think of it as the equivalent of an app store or the install.packages function in R. \nThen paste this code into the terminal.app.\n\nThere are a series of commands we can use to move around our files in the terminal.\n\npwd tells us the folder you are currently in\nls lists all the files in the folder you are in\ncd followed by a the name of a sub-folder of the folder you are currenly in navigates there\n.. moves you back up one folder from where you are\n\nWith all these tricks down we can then move the folder where we have our photograph saved and run exiftool followed by the name of our photograph.\n\n\n\nWorking with Images in R\nIf we want to work directly with image files in R, we need to install some extra packages. To do this we will use the magick package which can be used to import, position and manipulate images.\n\n#install.packages(\"magick\", repos = \"http://cran.us.r-project.org\")\n#install.packages(\"grDevices\", repos = \"http://cran.us.r-project.org\")\n\nlibrary(magick)\nlibrary(grDevices) # you will also need to install this package that Magick relies on\n\nWe can then load out picture of Siddhi in as an image file\n\ncat_picture &lt;- image_read(\"media/Siddhi.jpg\")\n\nWe can then use the image_info funciton to get some more information on the image\n\nimage_info(cat_picture)\n\n  format width height colorspace matte filesize density\n1   JPEG  3060   3024       sRGB FALSE   581659   72x72\n\n\nNotice how this does not include any EXIF data, only the information of the picture itself.\nWith the image loaded in we can then plot this in R. (rather than as an image on the website as I did above)\n\nplot(cat_picture)\n\n\n\n\n\n\n\n\nAs this is now a plot in R we can add and use all the functions as if we were making a data visualization. For example we can add axis to see how the image has been scaled.\n\nplot(cat_picture)\naxis(1)\naxis(2)\n\n\n\n\n\n\n\n\nNotice how the values on the axis match the width and height? This is because each pixel in the picture is one point on our plot!\nBefore we go any further lets put siddhi the right way up!\n\ncat_picture &lt;- image_rotate(cat_picture, degrees = 270 )\nplot(cat_picture)\n\n\n\n\n\n\n\n\nAs our image is being rendered in R by the plot() function this means we can use any of our normal visulization functions around or above the image.\nFor example:\n\n# we can create a blank plot\nplot(-99, -99, xlim=c(0,100), ylim=c(0,100))\n# and add the image to this blank plot\nrasterImage(cat_picture, xleft=0, xright=100, ybottom= 0, ytop= 100)\n# we can then add some data over the top\npoints(mtcars$mpg * 3, mtcars$qsec * 3,\n       col = 'red')\n\n\n\n\n\n\n\n\nAnd a few more examples:\n\npar(mfrow = c(2,2),\n    bg=\"seagreen\" )\n\nplot(-99, -99, xlim=c(0,100), ylim=c(0,100))\nrasterImage(cat_picture, xleft=0, xright=100, ybottom= 0, ytop= 100)\npoints(mtcars$mpg * 3, mtcars$qsec * 3,\n       col = 'red')\n\nplot(-99, -99, xlim=c(0,100), ylim=c(0,100))\nrasterImage(cat_picture, xleft=0, xright=100, ybottom= 0, ytop= 100)\nlines(mtcars$mpg * 3, mtcars$qsec * 3,\n       col = 'green')\n\nplot(-99, -99, xlim=c(0,100), ylim=c(0,100))\nrasterImage(cat_picture, xleft=0, xright=100, ybottom= 0, ytop= 100)\npoints(mtcars$mpg * 3, mtcars$qsec * 3,\n        col = 'orange',\n        pch = 17\n        )\n\nplot(-99, -99, xlim=c(0,100), ylim=c(0,100))\nrasterImage(cat_picture, xleft=0, xright=100, ybottom= 0, ytop= 100)\nlines(mtcars$mpg * 3, mtcars$qsec * 3,\n      col = 'pink',\n      type = 's')\n\n\n\n\n\n\n\n\nWe can also use R to manipulate the image itself using functions from magick.\n\npar(mfrow = c(1,1),\n    bg=\"white\" ) # resetting our canvas\n\n# cropping\ncat_ears &lt;- image_crop(cat_picture, \"1000x1000+1000\")\nplot(cat_ears)\n\n\n\n\n\n\n\n# blur\ncat_blur &lt;- image_blur(cat_picture, 30, 30)\nplot(cat_blur)\n\n\n\n\n\n\n\n# invert\ncat_negative &lt;- image_negate(cat_picture)\nplot(cat_negative)\n\n\n\n\n\n\n\n# transparency\ncat_transparent &lt;- image_colorize(cat_picture, opacity = 40, color = 'white')\nplot(cat_transparent)\n\n\n\n\n\n\n\n\nWe can also use magick to perform functions on our image to change the file. (Although none of this will be saved or overwrite the orgional file unless we tell R to do this)\n\ncat_small &lt;- image_resize(cat_picture, \"x100\" )\n\npar(mfrow = c(1,2))\n\nplot(cat_picture)\n\nplot(cat_small)\n\n\n\n\n\n\n\n\nNotice how this has pixelated cat_small, as par() is still plotting the two plot() the same size as each other, even though one image is much smaller!\nMost of these operations can be done with lots of other software but one of the advantages of R is that it allows us to automate some of these tasks, which might otherwise be too time consuming.\nFor example\n\n# looping through 100 different transparencies\npar(mfrow = c(10,10),\n    mar = c(0,0,0,0))\n\nfor(n in 1:100){\n  plot(image_colorize(cat_small,\n                      opacity = n,\n                      color = 'white'))\n     }\n\n\n\n\n\n\n\n\nThe magick library is also capable of much more complex image manipulation. Indeed, many programming languages make use of the same underlying ImageMagick code written in C for working with image data.\nWe are going to use the with the built in ImageMagick logo image, as this makes it easier to show off some of these more complex operations. You probably won’t need to make use of any of these features, but its good to know they are there!\n\n# first lets reset our layout\npar(mfrow = c(1,1),\n    bg=\"white\" )\n\nplot(logo) #this is the (now very retro) image magick logo\n\n\n\n\n\n\n\nimg &lt;- image_convert(logo, colorspace = \"Gray\")\ngradient_x &lt;- image_convolve(img, kernel = \"Prewitt\")\ngradient_y &lt;- image_convolve(img, kernel = \"Prewitt:90\")\ngradient &lt;- c(image_fx(gradient_x, expression = \"p^2\"),\n              image_fx(gradient_y, expression = \"p^2\"))\ngradient &lt;- image_flatten(gradient, operator = \"Plus\")\n\nplot(gradient)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Working with EXIF Data</span>"
    ]
  }
]